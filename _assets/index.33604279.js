import{d as a,l as t,$ as e,r as s,a0 as i,s as n,g as u,y as r,a1 as l,M as o,a2 as d,a3 as c,C as g}from"./index.719c5909.js";var[h,m,p]=r("pull-refresh"),v=["pulling","loosing","success"],f=g(a({name:h,props:{disabled:Boolean,successText:String,pullingText:String,loosingText:String,loadingText:String,pullDistance:[Number,String],modelValue:{type:Boolean,default:!1},successDuration:{type:[Number,String],default:500},animationDuration:{type:[Number,String],default:300},headHeight:{type:[Number,String],default:50}},emits:["refresh","update:modelValue"],setup(a,{emit:r,slots:g}){var h,f=t(),x=e(f),T=s({status:"normal",distance:0,duration:0}),D=i(),S=()=>{if(50!==a.headHeight)return{height:a.headHeight+"px"}},y=()=>"loading"!==T.status&&"success"!==T.status&&!a.disabled,H=(t,e)=>{var s=+(a.pullDistance||a.headHeight);T.distance=t,T.status=e?"loading":0===t?"normal":t<s?"pulling":"loosing"},b=()=>{var{status:t}=T;return"normal"===t?"":a[t+"Text"]||p(t)},V=()=>{var{status:a,distance:t}=T;if(g[a])return g[a]({distance:t});var e=[];return v.includes(a)&&e.push(u("div",{class:m("text")},[b()])),"loading"===a&&e.push(u(l,{class:m("loading")},{default:()=>[b()]})),e},N=a=>{(h=0===c(x.value))&&(T.duration=0,D.start(a))},B=a=>{y()&&N(a)},M=t=>{if(y()){h||N(t);var{deltaY:e}=D;D.move(t),h&&e.value>=0&&D.isVertical()&&(o(t),H((s=e.value,i=+(a.pullDistance||a.headHeight),s>i&&(s=s<2*i?i+(s-i)/2:1.5*i+(s-2*i)/4),Math.round(s))))}var s,i},Y=()=>{h&&D.deltaY.value&&y()&&(T.duration=+a.animationDuration,"loosing"===T.status?(H(+a.headHeight,!0),r("update:modelValue",!0),d((()=>r("refresh")))):H(0))};return n((()=>a.modelValue),(t=>{T.duration=+a.animationDuration,t?H(+a.headHeight,!0):g.success||a.successText?(T.status="success",setTimeout((()=>{H(0)}),+a.successDuration)):H(0,!1)})),()=>{var a={transitionDuration:T.duration+"ms",transform:T.distance?"translate3d(0,"+T.distance+"px, 0)":""};return u("div",{ref:f,class:m()},[u("div",{class:m("track"),style:a,onTouchstart:B,onTouchmove:M,onTouchend:Y,onTouchcancel:Y},[u("div",{class:m("head"),style:S()},[V()]),null==g.default?void 0:g.default()])])}}}));export{f as P};
